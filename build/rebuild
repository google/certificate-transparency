#!/bin/sh

# Helper for gclient

INSTALL=`pwd`/install
GMOCK=`pwd`/googlemock
PATH=$INSTALL/bin:$PATH

set -e

cd certificate-transparency
if [ ! -f configure ]
then
	./autogen.sh
fi
if [ ! -f Makefile ]
then
    # FIXME: MacOS needs -lresolv
    #CPPFLAGS="-I$INSTALL/include" LDFLAGS="-L$INSTALL/lib" LIBS="-lresolv" ./configure GMOCK_DIR=$GMOCK
    CPPFLAGS="-I$INSTALL/include" LDFLAGS="-L$INSTALL/lib" LIBS="-lpthread" ./configure GMOCK_DIR=$GMOCK
fi

# FIXME: most platforms want make, FreeBSD wants gmake
gmake
